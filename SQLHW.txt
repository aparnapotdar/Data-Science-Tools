USE sakila;

SELECT first_name, last_name FROM actor;

SELECT CONCAT(upper(first_name), " ",upper(last_name) ) as "Actor Name" FROM actor;

SELECT actor_id, first_name, last_name 
FROM actor
WHERE upper(first_name) like '%JOE%';


SELECT actor_id, first_name, last_name 
FROM actor
WHERE upper(last_name) like '%GEN%';

SELECT actor_id, first_name, last_name 
FROM actor
WHERE upper(last_name) like '%LI%'
ORDER BY last_name, First_name;

SELECT country_id, Country FROM country
WHERE country IN ("afghanistan", "bangladesh", "china");

ALTER TABLE actor
ADD COLUMN middle_name varchar(45) 
AFTER first_name;

ALTER TABLE actor
MODIFY COLUMN middle_name blob;

ALTER TABLE actor
DROP COLUMN middle_name;

SELECT last_name, COUNT(*) FROM actor
GROUP BY last_name
ORDER BY last_name;

SELECT last_name, COUNT(*) FROM actor
GROUP BY last_name
HAVING COUNT(*) > 1
ORDER BY last_name;

select * from actor where upper(last_name) =  "WILLIAMS" ;

UPDATE actor
SET first_name = "HARPO"
WHERE upper(first_name) = "GROUCHO"
AND upper(last_name) =  "WILLIAMS"
LIMIT 1;

UPDATE actor
SET first_name = "GROUCHO"
WHERE upper(first_name) = "HARPO"
AND upper(last_name) =  "WILLIAMS"
LIMIT 1;


CREATE TABLE `address` (
  `address_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `address` varchar(50) NOT NULL,
  `address2` varchar(50) DEFAULT NULL,
  `district` varchar(20) NOT NULL,
  `city_id` smallint(5) unsigned NOT NULL,
  `postal_code` varchar(10) DEFAULT NULL,
  `phone` varchar(20) NOT NULL,
  `location` geometry NOT NULL,
  `last_update` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`address_id`),
  KEY `idx_fk_city_id` (`city_id`),
  SPATIAL KEY `idx_location` (`location`),
  CONSTRAINT `fk_address_city` FOREIGN KEY (`city_id`) REFERENCES `city` (`city_id`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=606 DEFAULT CHARSET=utf8;



SELECT s.first_name, s.last_name, CONCAT(a.address, ", ", a.district,", ", a.postal_code) AS address
FROM staff AS s INNER JOIN address AS a ON s.address_id = a.address_id;

SELECT s.first_name, s.last_name, SUM(amount) AS "Total Amount Aug 2005"
FROM staff AS s INNER JOIN payment AS p ON s.staff_id = p.staff_id
AND payment_date like "2005-08%"
GROUP BY s.first_name, s.last_name;


SELECT f.title, COUNT(fa.actor_id) as "Number of Actors"
FROM film AS f INNER JOIN film_actor AS fa ON f.film_id = fa.film_id
GROUP BY f.title

SELECT count(*) FROM film
WHERE lower(title)  like "%hunchback%impossible%";

SELECT * from payment
select * from customer

SELECT c.first_name ,c.last_name , SUM(p.amount) as "Total Amount Paid"
FROM customer AS c INNER JOIN payment AS p ON c.customer_id = p.customer_id
GROUP BY c.first_name ,c.last_name
ORDER BY c.last_name;

SELECT title 
FROM film AS f INNER JOIN language as l ON f.language_id = l.language_id 
and (upper(f.title) like "Q%" OR upper(f.title) like "K%") 
and  l.name="English";

SELECT first_name, last_name from actor
WHERE actor_id IN 
(
SELECT actor_id FROM film_actor
WHERE film_id in
(
SELECT film_id FROM film
WHERE lower(title) like "%alone%trip%"
 )
 )
 ORDER BY last_name;
 
 
SELECT first_name, last_name, email
FROM customer 
WHERE address_id in
(
SELECT address_id 
FROM Address
WHERE city_id in
(
SELECT city_id 
FROM city
WHERE country_id in
(
SELECT country_id 
FROM Country
WHERE lower(country) = "canada"
)
)
);

Resume at 7D

 
 